<div class="col-sm-12">
  <div class="row">
    <div class="col-sm-12 col-md-6">
      <h2>Quote Topic Suggestions - <%= QuoteTopicSuggestion.where(read: false).count %></h2>
    </div>
    
    <div class="col-sm-12 col-md-3 col-md-offset-3">
      <%= form_tag admin_quote_topic_suggestions_url, method: :get do %>
        <%= select_tag "topic", options_for_select(Topic.all.order(name: :asc).collect { |t| [t.name, t.id] }, params[:topic]), prompt: "Filter by Topic",onchange: "this.form.submit();", class: "select form-control inline" %>
      <% end %>
    </div>
  </div>
  
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th width="50%" class="text-center">Quote</th>
        <th width="15%" class="text-center">Topic</th>
        <th width="20%" class="text-center">Source</th>
        <th width="15%" class="text-center" colspan="3">Manage</th>
      </tr>
    </thead>
  
    <tbody>
      <% @quote_topic_suggestions.each do |quote_topic_suggestion| %>
        <tr>
          <td><%= quote_topic_suggestion.quote.text %></td>
          <td class="text-center"><%= link_to quote_topic_suggestion.topic.name, admin_topic_url(quote_topic_suggestion.topic) %></td>
          <td class="text-center"><%= link_to quote_topic_suggestion.quote.source.name, admin_quote_source_url(quote_topic_suggestion.quote) %> <%= quote_topic_suggestion.quote.source.published ? '<span class="badge badge-default">P</span>'.html_safe : '<span class="badge badge-default">D</span>'.html_safe %></td>
          <td class="text-center"><%= link_to '<i class="e-icon-pencil"></i>'.html_safe, edit_admin_quote_path(id: quote_topic_suggestion.quote_id), target: "_blank" %></td>
          <td class="text-center"><%= link_to '<i class="e-icon-check"></i>'.html_safe, accept_admin_quote_topic_suggestion_url(id: quote_topic_suggestion.id), class:"accept_suggestion", remote: true %></td>
          <td class="text-center"><%= link_to '<i class="e-icon-cross"></i>'.html_safe, decline_admin_quote_topic_suggestion_url(id: quote_topic_suggestion.id), class:"decline_suggestion", remote: true %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
  
  <div class="text-center">
    <%= paginate @quote_topic_suggestions, :views_prefix => 'kaminari_bootstrap' %>
  </div>
</div>

<script type="text/javascript">
  $(function() {
    $(".accept_suggestion")
    .on("ajax:complete", function(e, data, status, xhr) {
        $(this).closest("tr").remove();
    });
  
    $(".decline_suggestion")
    .on("ajax:complete", function(e, data, status, xhr) {
        $(this).closest("tr").remove();
    });
  });
</script>